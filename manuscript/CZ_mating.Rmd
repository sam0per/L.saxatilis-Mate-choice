---
title: "Mating model for the four contact zones"
author: "Samuel Perini"
output: pdf_document
csl: journal-of-evolutionary-biology.csl
bibliography: library.bib
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# List of packages for session
.packages = c("ggplot2", "dplyr", "rstan", "tibble", "boot", "bayesplot", "Rmisc", "tidyverse",
              "bbmle")

# Install CRAN packages (if not already installed)
.inst <- .packages %in% installed.packages()
if(length(.packages[!.inst]) > 0) install.packages(.packages[!.inst])

# Load packages into session 
lapply(.packages, require, character.only=TRUE)
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
```

## Abstract

$\vspace{1cm}$

...

Here we describe the impact of the mating patterns on the evolution of reproductive barriers between two ecotypes of _Littorina saxatilis_. Firstly, we determine the relationship between the probability of mounting and the shell sizes of the mating pairs and demonstrate that this relationship is constant across shores and between ecotypes. The statistical model is built from a Bernoulli distribution in a Bayesian framework because it allows us to estimate unknown mating parameters (e.g., preference and choosiness) given the data and a set of prior distributions. Secondly, we explore the genetic basis of mate choice using computer simulations for a preference/trait rule and a matching rule.

$\vspace{0.5cm}$

```{r fig1, fig.height=4, fig.width=6, fig.align='center', echo=FALSE}
CZ_data = read.csv("tables/CZ_size_mating.csv",sep = ";")
breaks = c(-2,seq(-1.5,1.5,0.1),2)
CZ_data$bin = cut(CZ_data$size_ratio,breaks)
CZ_data_bin <- 
  CZ_data %>%
  group_by(bin) %>%
  dplyr::summarise(mount = mean(mountYN), 
                   uci_mount = CI(mountYN)['upper'], 
                   lci_mount = CI(mountYN)['lower'],
                   mean_ratio = mean(size_ratio),
                   y_rep = mean(y_rep),
                   preds_mount = mean(y_preds)) %>% 
  mutate(lci_mount = replace(lci_mount, which(lci_mount<0), 0))

ggplot(data = CZ_data) +
  geom_vline(xintercept = 0, alpha=0.6) +
  geom_vline(xintercept = as.numeric(CZ_data_bin[which.max(CZ_data_bin$mount),'mean_ratio']),
             linetype='dashed', alpha=0.4) +
  geom_errorbar(data = CZ_data_bin, aes(x = mean_ratio, ymin = lci_mount, ymax = uci_mount),alpha = 0.2) +
  scale_colour_manual(values=c("blue")) +
  geom_point(data = CZ_data_bin, aes(x = mean_ratio, y = mount, col="observations")) +
  scale_x_continuous(breaks=seq(-1.5,1.5,0.5)) +
  labs(size="bin size",x="female - male size (ln)",
       y="probability of mounting",col="") +
  theme(axis.title = element_text(face = "bold", size = 13))

```
\fontsize{8}{9}
\selectfont
Figure 1. **Gaussian relationship between proportion of mounting success and female-male size ratio.** Each blue dot consists of the average number of mounting events (y axis) occurred within a specific range of shell size (x axis in the natural logarithmic scale). Grey error bars represent 95% confidence interval. 
\normalsize

\newpage

## Materials and methods

### _SAMPLING_



### _PHENOTYPES_



### _NO-CHOICE MATING EXPERIMENT_



### _GAUSSIAN FORMULATION_

The Gaussian formula is a hierarchical model built under a Bayesian framework that allows to predict the probability of mounting success and to estimate directly the parameters for chossiness or strength of preference $\Sigma$ and preference or preferred trait value $M$. It is hierarchical because the prior distribution for the parameters are given an additional layer of information in order to maintain sufficient flexibility or uncertainty for potential data points that do not strictly follow our expectations. Sexual selection and assortative mating are then emergent properties, measured by the correlation between male trait value and mating success (sexual selection) or the correlation between male and female traits (assortative mating). To give an example, when $M = 0$, the most successful pairs are those with no difference in size between the female and the male (like mates with like scenario). Other values of $M$ instead would indicate a favourable size ratio which could be either negative (females smaller than males scenario) or positive (females larger than males scenario). All three scenarios involve a non-zero effect of assortative or disassortative mating. Random mating occurs when choosiness is large and the mounting probability tends to be uniform across the available range of size ratio.

$\vspace{0.5cm}$

The mate-choice equation aims to detect relevant deviations from the basic assumption of size-assortative mating. The simplest form of the model contains five parameters, each of which can include further phenotypic variables as covariates and, consequently, increase the model complexity. The first parameter, $A$, defines the intercept of the mating curve and the second one, $\Lambda$, modifies the scale of the curve for a computed estimate of the third parameter $M$ (i.e., preference) and the fourth parameter $\Sigma$ (i.e., choosiness). The preference stands for the value of size ratio with the highest probability of mounting, the peak of the curve, and choosiness determines the decline of the mounting probability as the width of the curve. Finally, the fifth paramter, $\Gamma$, controls for the asymmetry between the left and the right end tails.

$$mountYN_i \sim Bin(1, p_i), logit(p_i) = A + \Lambda * e^{-\frac{(ratio_i-M)^2}{2\Sigma^2}} + \Gamma * ratio_i$$

Additionally, the term $A$ can depend on the shore, the ecotype and shape covariates.

$$A_i = \alpha_{1,shore_i} + \alpha_{2,eco_i} + \alpha_3 * shape_i$$

The same relationship between covariates can also be added into the other terms.

$$\Lambda_i = \lambda_{1,shore_i} + \lambda_{2,eco_i} + \lambda_3 * shape_i$$

$$M_i = \mu_{1,shore_i} + \mu_{2,eco_i} + \mu_3 * shape_i$$

$$\Sigma_i = \sigma_{1,shore_i} + \sigma_{2,eco_i} + \sigma_3 * shape_i$$

$$\Gamma_i = \gamma_{1,shore_i} + \gamma_{2,eco_i} + \gamma_3 * shape_i$$

$\vspace{0.5cm}$

The initial model is extended with a linear effects between shore, ecotype and shape variables for each of the five parameters. The two intercept coefficients are indicative of the shore and the ecotype values, respectively. The regression coefficients are representative for the shape measures.

The intercept and regression coefficients are the unknown and desired parameters whose posterior distributions are sampled from weakly informative priors as recommended by the Stan authors [[web reference](https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations)]. Suitable priors for logistic regression coefficients are Student-t distributions because they present light tails that can adapt reasonably well to the data while enabling the production of robust posterior distributions [@Ghosh2017]. However, our model did not reach convergence when these guidelines were transferred to the data. Although the present analysis computes the predicted probability of mounting using a Bernoulli distribution, the final choice of the prior distributions was based on the recommendations for hierarchical models [@Gelman2006]. The half-Cauchy family was selected to restrict very large values of standard deviations and to improve the behaviour around 0.

The importance of each coefficient is established by its posterior distribution which also corresponds to the uncertainty of the parameter estimate. A parameter with posterior distribution that is centred at zero is indicative of an irrelevant effect of the corresponding covariate on the probability of mounting. The opposite is true when the mean of the posterior distribution is shifted from zero.

$\vspace{1cm}$

\newpage
## Results



$\vspace{1cm}$

The model selection procedure based on the two information criteria requires an additional step to assess the performance of the logistic regression. The ability to predict the response variable mounting success can be estimated using re-sampling techniques such as cross-validation and bootstrap. In our case, repeated 10-fold cross-validation was applied before the measurement of accuracy for each top models. There is no evident difference between accuracy estimates and all the model coincides in terms of predictive performance (Table 3). 

$\vspace{0.5cm}$

Most of the parameters coefficients are centred close to zero to a degree of uncertainty that depends on the different type of shores (Fig. 3, left panel), on the variation in the reference ecotype (Fig. 3, middle panel), on the shape of the test snails and size ratio of the mating pairs (Fig. 3, right panel). Particularly, the first three contact zones, CZA, CZB and CZC, show consistent parameter values compared to the fourth contact zone CZD which is determined by a lower $\alpha$ and smaller $\alpha\_ta$. Negative coefficients of these parameters correspond to a reduced $level$ or curve height and a weak $rtail$ or asymmetry between right and left end tails (Fig. 4). The terms $level$ and $rtail$ show also a distinction between ecotypes (Fig. 3, middle panel). The mating pairs composed by the wave reference are predicted to yield the lowest probability of mounting success (Fig. 4, bottom-left) and a nearly neutral asymmetry in successful events across the two ends of the probability curve (Fig. 4, bottom-right).

The other parameter that shows a shore-specific trend is $\alpha\_sd$ as it takes negative values only in shore three (CZC) and determines the lowest estimates of the term $\sigma$ (Fig. 5).

$\vspace{0.5cm}$

![fig3](figures/gaus_size_pars_dens.pdf){ width=33% }
\fontsize{8}{9}
\selectfont
Figure 3. **The range of the parameter values is indicative to the effect of the associated covariate on the probability of mounting.** Mean (black filled dot), 80% (red line) and 90% (black line) confidence intervals of the parameter posterior distribution. The left panel shows the first intercept coefficients $\alpha$'s for each shore (one = CZA, two = CZB, three = CZC, four = CZD), the middle panel contains the second intercept coefficients $\delta$'s for each ecotype (one = crab, two = wave) and the right panel illustrates the regression coefficients $\beta$'s and $\gamma$ for shape and size ratio, respectively. A mean estimate equal to zero corresponds to a negligible effect of the associated explanatory variable.
\normalsize

$\vspace{0.5cm}$

```{r fig4a, out.width='.49\\linewidth', fig.height=4, fig.width=6, fig.show='hold', fig.align='center', echo=FALSE, message=FALSE}
CZ_bayes = read.csv("../CZ_ABCD/final_data/CZABCD_final_data.csv",sep = ";")
#CZ_bayes$shore = as.factor(CZ_bayes$shore)
#levels(CZ_bayes$shore) = c("CZA","CZB","CZC","CZD")
#CZ_bayes$ref_ecotype = as.factor(CZ_bayes$ref_ecotype)
#levels(CZ_bayes$ref_ecotype) = c("crab","wave")
ggplot(data = CZ_bayes,aes(size_ratio,y_rep,col=as.factor(ref_ecotype))) +
  facet_wrap(~ as.factor(CZ_bayes$shore)) +
  geom_point(size=0.8) +
  geom_vline(xintercept = CZ_bayes$line) +
  scale_color_manual(values=c("gold2","blue")) +
  labs(col="ref ecotype",size="bin size",x="female size - male size (ln)",
       y="predicted probability of mounting", title = "Predicted mounting probability") +
  theme(legend.title = element_text(size = 11,face = "bold"),
        axis.title = element_text(face = "bold"),
        plot.title = element_text(size = 13,face = "bold",hjust = 0.5))

ggplot(data = CZ_glm_bin,aes(size_ratio,mount,col=as.factor(ref_ecotype))) +
  geom_point(aes(size=CZ_glm_bin$count)) +
  geom_vline(xintercept = CZ_glm_bin$line) +
  facet_wrap(~ as.factor(CZ_glm_bin$shore)) +
  scale_color_manual(values=c("gold2","blue")) +
  labs(col="ref ecotype",size="bin size",x="female size - male size (ln)",
       y="proportion of mounts in each bin",title = "Observed mounting") +
  theme(legend.title = element_text(size = 11,face = "bold"),
        axis.title = element_text(face = "bold"),
        plot.title = element_text(size = 13,face = "bold",hjust = 0.5))
```

```{r fig4b, out.width='.49\\linewidth', fig.height=5, fig.width=7, fig.show='hold', fig.align='center', echo=FALSE, message=FALSE}
ggplot(CZ_bayes,aes(log_female,log_male,shape=ref_ecotype,col=sim_le)) +
  facet_wrap(~ as.factor(CZ_bayes$shore)) +
  geom_point(size=1.5) +
  scale_color_gradient2(low = "black", mid = "grey", high = "white", midpoint = -0.7) +
  labs(shape="ref. ecotype", col="level", x="female size (ln)",
       y="male size (ln)", title = "Predicted curve intercept") +
  theme(legend.title = element_text(size = 11,face = "bold"),
        axis.title = element_text(face = "bold"),
        plot.title = element_text(size = 13,face = "bold",hjust = 0.5))

ggplot(CZ_bayes,aes(log_female,log_male,shape=ref_ecotype,col=sim_ta)) +
  facet_wrap(~ as.factor(CZ_bayes$shore)) +
  geom_point(size=1.5) +
  scale_color_gradient2(low = "black", mid = "grey", high = "white", midpoint = -0.5) +
  labs(shape="ref. ecotype", col="tail asymmetry", x="female size (ln)",
       y="male size (ln)", title = "Predicted tail asymmetry") +
  theme(legend.title = element_text(size = 11,face = "bold"),
        axis.title = element_text(face = "bold"),
        plot.title = element_text(size = 13,face = "bold",hjust = 0.5))
```
\fontsize{8}{9}
\selectfont
Figure 4. **Visual evaluation of the ability of the Gaussian model to fit the observed data and to generate predictions for the terms $level$ and $rtail$**. The lowest mounting probability and the leasr asymmetry are predicted in shore CZD (top panels). The intercept declines as the reference snail belongs to the wave ecotype and the test snail is progressively crab-like. The asymmetry decreases as the males become larger than the females and the reference morph is classified as crab (bottom panels). Size and shape are positively correlated.
\normalsize

$\vspace{0.5cm}$

The shore effect extends also to the term $\mu$ but I am going to limit my interpretations because I would like to hear **your opinion** on the biological relevance of tiny but evident numerical differences in the parameter estimates (Fig. 6, left panel).

* The value of $\mu$ is positive in all the shores and it ranges between 0.1 and 0.3. A single value could be assigned to all the locations because the coefficients of $\alpha\_av$'s are basically 0 (Table 4).

$\vspace{0.5cm}$

\fontsize{8}{9}
\selectfont
\begin{center}
Table 4. Generated estimates for the shore parameters. All the intervals contain the value 0
\end{center}
\small
```{r table4, message=FALSE, warning=FALSE, echo=FALSE, results='asis'}
CZ_gau2_alpha = read.csv("../CZ_ABCD/results/CZABCD_gau2_alpha.csv",sep = ";")
names(CZ_gau2_alpha) = c("parameter","mean","se_mean","sd","2.5%","25%","50%","75%","97.5%","n_eff","Rhat")
pander(CZ_gau2_alpha)

```
\normalsize

$\vspace{0.5cm}$

* The interval estimates of the parameters $\alpha\_av[1]$ and $\alpha\_av[2]$ are slightly positive (Fig. 3, left panel) and they would suggest larger values of $\mu$ in shore CZA and CZB than in CZC and CZD. Therefore, the first two contact zones would show means of the predicted probability curves shifted away from 0 towards positive values. 

* A linear model with response variable $\mu$ and predictors shore, reference ecotype and shape returns very small coefficients for the shore effect but slightly larger ones for the reference ecotype effect (Table 5). 
Are these small values biologically relevant?
Does a difference of -0.08 in $\mu$ between crab and wave reference ecotype matter?

$\vspace{0.5cm}$

\fontsize{8}{9}
\selectfont
\begin{center}
Table 5. Coefficient estimates (95% confidence intervals) of the linear model for the term $\mu$. The exponential transformation was necessary to handle shape values very close to 0. 
\end{center}
\small
```{r table5, message=FALSE, warning=FALSE, echo=FALSE, results='asis'}
CZ_av_ci95 = read.csv("../CZ_ABCD/results/CZABCD_av_ci95.csv",sep = ";")
names(CZ_av_ci95) = c("","2.5%","97.5%")
pander(CZ_av_ci95)
```
\normalsize

$\vspace{0.5cm}$

* The observed relationship in CZC and CZD might depend on the reference ecotype because the size ratio optima are not overlapping as in CZA and CZB (Fig. 1). The resolution of the term $\mu$ might increase under a model with the interaction effect between shore and reference ecotype, and between shape and reference ecotype. The generated $\mu$ estimates would differ by shore (CZA and CZB against CZC and CZD), and by ecotype (CZC and CZD would show one optimum size ratio for the refrence wave and one for the reference crab).

$\vspace{0.5cm}$

Shore variation can partly explain the mating pattern observed in _L. saxatilis_. The four mounting probability curves differ in height, standard deviation and tail asymmetry. Yet, the current Gaussian model provides ambiguous results about the mean points with the highest mounting success. The linear effect that defines $\mu$ could include additional interactions such as between shore and reference ecotype, and between shape and reference ecotype in order to improve the goodness of fit.

The covariate reference ecotype was associated with the second set of intercept parameters and it was treated exclusively as an additive effect because of computational reasons. The next model will contain further parameters for the interaction terms. Major discrepancies between crab [1] and wave [2] parameters are not detected and the absence of an ultimate reference ecotype effect relatively agrees with both the observed data and the standard logistic regression (Fig. 3, middle panel). On the other hand, the Gaussian formulation identifies minor deviations between ecotypes in all the parameters (Table 6). Besides the differences in $level$ and $rtail$ due to the reference ecotype (Fig. 4, bottom panels), other subtle distinctions are found in the term $\sigma$ and $\mu$. The crab individuals show a narrower width of the mounting curve than the wave ones and thus, a stronger impact of sexual selection up to its maximum in CZC (Fig. 5). The second deviation appears when the reference belong to the crab ecotype because the mean of the probability curve is larger than in mating pairs with the wave reference (Fig. 6).
The relevance of the minor differences between crab and wave is not equivalent for all the terms. The most pronounced ecotype distinction is carried by the terms $rtail$ and $level$ (Table 6).

$\vspace{0.5cm}$

```{r fig5, fig.height=5, fig.width=6, fig.show='hold', fig.align='center', echo=FALSE, message=FALSE}
ggplot(CZ_bayes,aes(log_female,log_male,shape=ref_ecotype,col=sim_sd)) +
  facet_wrap(~ as.factor(CZ_bayes$shore)) +
  geom_point(size=1.5) +
  scale_color_gradient2(low = "black",mid = "grey", high = "white",midpoint = 0.26) +
  labs(shape="ref. ecotype", col=expression(sigma~"(exp)"), x="female size",
       y="male size", title = "Predicted sexual selection") +
  theme(legend.title = element_text(size = 11,face = "bold"),
        axis.title = element_text(face = "bold"),
        plot.title = element_text(size = 13,face = "bold",hjust = 0.5))
```
\fontsize{8}{9}
\selectfont
Figure 5. **Strength of sexual selection depends on both the reference ecotype and the shore variation.** Sexual selection is predicted to reduce trait variation the most in mating pairs of the crab reference ecotype and the least in mating pairs of the wave reference ecotype. The lowest values of $\sigma$ are obtained in shore CZC and thus, the strongest effect of sexual selection. Values of $\sigma$ are calculated using the exponential function.
\normalsize

$\vspace{0.5cm}$

```{r fig6, out.width='.49\\linewidth', fig.height=5, fig.width=6, fig.show='hold', fig.align='center', echo=FALSE}
ggplot(CZ_bayes,aes(Shape,sim_av,shape=ref_ecotype,col=y_rep)) +
  facet_wrap(~ as.factor(CZ_bayes$shore)) +
  geom_point(size=1.5) +
  geom_vline(xintercept = CZ_bayes$line) +
  scale_color_gradient(low = "black",high = "red") +
  labs(shape="ref. ecotype",x="shape", y=expression(mu),
       col="mount prob", title = "Predicted disassortative mating") +
  theme(legend.title = element_text(size = 11,face = "bold"),
        axis.title = element_text(face = "bold"),
        plot.title = element_text(size = 13,face = "bold",hjust = 0.5))

ggplot(CZ_bayes,aes(log_female,log_male,shape=ref_ecotype,col=sim_av)) +
  facet_wrap(~ as.factor(CZ_bayes$shore)) +
  geom_point(size=1.5) +
  scale_color_gradient2(low = "black",mid = "grey", high = "white",midpoint = 0.15) +
  labs(shape="ref. ecotype", col=expression(mu), x="female size",
       y="male size", title = "Predicted disassortative mating") +
  theme(legend.title = element_text(size = 11,face = "bold"),
        axis.title = element_text(face = "bold"),
        plot.title = element_text(size = 13,face = "bold",hjust = 0.5))
```
\fontsize{8}{9}
\selectfont
Figure 6. **Does $\mu$ depend on both the shore and the reference ecotype effect?** Successful mating pairs are generally composed by individuals of similar shapes and a female larger than a male up to an average optimum that differs marginally across shores and between ecotypes (CZA, crab = 0.19 $\pm$ 0.04 and wave = 0.17 $\pm$ 0.03; CZB, crab = 0.19 $\pm$ 0.03 and wave = 0.16 $\pm$ 0.03; CZC, crab = 0.15 $\pm$ 0.05 and wave = 0.13 $\pm$ 0.03; left panel). The lowest values of $\mu$ are produced when the reference is wave and the test is crab. Average estimates are measured for similar sizes and shapes (right panel).
\normalsize

$\vspace{1cm}$

\fontsize{8}{9}
\selectfont
\begin{center}
Table 6. Generated estimates for the reference ecotype parameters. All the intervals are close to 0 and show minor deviations between crab [1] and wave [2]. The ecotypes differ mainly for the term $level$ and $rtail$. Only the mean and the standard deviation of each equation terms are reported for the total crab and wave reference ecotype.
\end{center}
\small
```{r table6, message=FALSE, warning=FALSE, echo=FALSE}
CZ_gau2_delta = read.csv("../CZ_ABCD/results/CZABCD_gau2_delta.csv",sep = ";")
names(CZ_gau2_delta) = c("parameter","mean","se_mean","sd","2.5%","25%","50%","75%","97.5%","n_eff","Rhat")
pander(CZ_gau2_delta)
library(dplyr)
CZ_gau2_ref = group_by(CZ_bayes, ref_ecotype) %>%
  summarise(
    count = n(),
    level = mean(sim_le, na.rm = TRUE),
    lev_sd = sd(sim_le, na.rm = TRUE),
    mu = mean(sim_av, na.rm = TRUE),
    mu_sd = sd(sim_av, na.rm = TRUE),
    sigma = mean(sim_sd, na.rm = TRUE),
    sig_sd = sd(sim_sd, na.rm = TRUE),
    tail = mean(sim_ta, na.rm = TRUE),
    tail_sd = sd(sim_ta, na.rm = TRUE)
  )
pander(CZ_gau2_ref)
```
\normalsize

\newpage

## Discussion

**1. Standard logistic regression**

The patterns of mate choice in _L. saxatilis_ are not exactly straightforward and it is not unusual for a sympatric scenario where incipient populations have not developed robust prezygotic barriers [@Kopp2017]. Although mechanisms of mate discrimination have been previously identified [@Hollander2005; @Johannesson2008], there was no evidence of precopulatory inbreeding avoidance between wild and sib individuals [@Ng2016]. Furthermore, the dense intertidal populations have lost the superfluous production of pheromones which are often used for precopulatory choice in other organisms [@Mays2004]. Assortative mating was recognised to be dependent on size [@Erlandsson1998; @Johannesson2008] but other preferences might contribute in multiple mechanisms during the speciation process like in the case of the treehoppers [@Cocroft2008].

The most likely hypothesis of sexual isolation in the intertidal snails involves the occurrence of reproductive barriers after copulation and before zygosis where the female preference acts upon the pool of stored sperms. Under the circumstances of convenience polyandry and postcopulatory sexual selection [@Panova2010; @Johannesson2016], the patterns of premating behaviour are expected to be relatively indefinite. Consequently, it is legitimate if the procedure of model selection did not return a single and unequivocal relationships between phenotypes and probability of mounting.

All the models built under a standard logistic regression contained the significant effects of size ratio, size ratio squared, size ratio cube, shape and shore. Therefore, the mounting success is certainly determined by the size difference between males and females, by the shape of the shell and by the environmental properties of the shore. These are interpretations well supported by both the data collected during the mating experiments and previous studies [@Erlandsson1998; @Johannesson2008]. The main challenges are introduced when accurate predictions of mounting probability lead to different biological explanations. For example, the presence of the interaction effect with the variable reference ecotype implies the additional preference for the typical traits of either wave or crab morph. Premating isolation in the species _L. saxatilis_ shows a strong component of shell size but the evolution of the reproductive barriers cannot simply involve a single mechanism. The results from multiple and robust models underline the delicate patterns of mate choice during speciation with gene flow.

$\vspace{1cm}$

**2. Gaussian formulation**

The major difference between the standard approach and the Gaussian formulation consists of the degree of resolution and depth that each analysis can provide. The four terms of the mating equation are defined as linear effects of several covariates and each of them controls for a specific factors of the probability curve. The height, the mean, the standard deviation and the tail asymmetry are manipulated by parameters associated with the selected variables such as shore, reference ecotype and shape. The parameters are given weakly informative priors and the derived posterior distributions are used for the prediction of the main effects on the probability of mounting. Hence, the mechanism of mate choice can be practically divided into the four principal components that underlie the patterns of assortative mating in _L. saxatilis_.

The first one is the term $level$ or the intercept of the curve. It takes the lowest value in the shore CZD while keeping a difference between crab and wave reference ecotype. The latter is responsible for the minimum estimate of the probability of mounting success when the other terms of the equation are equal to zero.

_I am still confused about the meaning of the intercept, what could be the biological explanation for the more negative values in wave than in crab?_

The second factor is the term $\mu$ and it stands for the mean of the probability curve. It was found to depend marginally on the reference ecotype and the test shape. The mounting probability is predicted to achieve the peak when both the individuals of the mating pair share similar ecotype characteristics. Nevertheless, this result is contrasted by a much stronger effect determined by the difference in size between females and males of the mating pairs. Shell size can be considered the most important effect that influences the optimum of mounting success which is obtained at $\mu = 0.15$.

The third one is defined as $\sigma$ and it represents the standard deviation of the mounting curve. Its strength varies according to both the shore conditions and the ecotype characteristics of the mating pairs. The lowest intensity was estimated in the shore CZC but the pattern of variation was consistent across locations even though the differences were measured on a small scale. When the reference snail belongs to the wave ecotype, the values of sigma decreases as the test snail becomes wave-like. The opposite is true for a crab reference because the width grows narrow as the test snail resembles the wave ecotype. Overall, the mating pairs composed by a crab reference and a wave-like test snail are the most affected by sexual selection.

The fourth component is $rtail$ and its values are proportional to the degree of asymmetry between the right and the left tail of the probability curve. The most negative values were generated for the combinations of males larger than females and for reference snails that belonged to the crab ecotype, with a small negative effect of the shape of the test snail.

_What else could we conclude from the tail asymmetry?_

Assortative or disassortative mating can generate sexual selection if it reduces trait variation of successful individuals in one sex. Individuals of the species _L. saxatilis_ exhibit a mounting strategy that is primarily based on the shell size of the potential partners. The highest mounting success is obtained for encounters in which the female is 1.2 times larger than the male. Therefore, it is generally advantageous for males to maintain small shell sizes. The optimum difference in size between males and females creates a candidate scenario for sexual selection to unfold. Nevertheless, the current study cannot establish whether sexual selection promotes or inhibits the divergence progress. In fact, the consequences of the mating patterns are tightly connected to the genetic basis of the female preference and the male mating trait. The strength of linkage disequilibrium under a preference/trait rule is a crucial factor for the effects of sexual selection on speciation with gene flow.


\newpage

# References
